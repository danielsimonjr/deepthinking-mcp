{
  "phase": "15A",
  "sprint": 1,
  "title": "Remove Unnecessary Abstractions",
  "week": "Week 1",
  "effort": "6-7 hours",
  "status": "pending",
  "version": "9.0.0",
  "description": "Eliminate Factory/Builder/Strategy pattern overhead for simple operations. Replace singleton registry with simple Map, remove lazy initialization, consolidate interfaces with single implementations.",
  "tasks": [
    {
      "id": "15A.1.1",
      "category": "Architecture",
      "description": "Inline ModeHandlerRegistry - Replace singleton registry with simple Map literal in ThoughtFactory. Remove 12+ call chain indirection for thought creation.",
      "status": "pending",
      "priority": "high",
      "estimatedHours": 1.5,
      "agent": "haiku",
      "files": {
        "simplify": [
          "src/modes/registry.ts"
        ],
        "modify": [
          "src/services/ThoughtFactory.ts",
          "src/index.ts"
        ]
      },
      "instructions": [
        "Read src/modes/registry.ts to understand ModeHandlerRegistry API",
        "Create handler Map in ThoughtFactory: const handlers: Map<ThinkingMode, ModeHandler>",
        "Replace registry.getHandler(mode) with handlers.get(mode)",
        "Remove registry import and instantiation",
        "Run npm run test:run to verify no breakage"
      ],
      "successCriteria": [
        "Registry class simplified or inlined",
        "All 5,148 tests pass",
        "No change to MCP API behavior"
      ],
      "rollbackPlan": "Restore registry.ts from git, revert ThoughtFactory changes"
    },
    {
      "id": "15A.1.2",
      "category": "Performance",
      "description": "Eliminate Lazy Service Initialization - Replace 4 async getter patterns with direct imports at module level for CLI tool.",
      "status": "pending",
      "priority": "high",
      "estimatedHours": 1.0,
      "agent": "haiku",
      "files": {
        "modify": [
          "src/index.ts"
        ]
      },
      "instructions": [
        "Read lines 40-120 of src/index.ts to find lazy getters",
        "Replace with direct imports at top of file",
        "Change all 'await getSessionManager()' to just 'sessionManager'",
        "Remove 'async' from handlers that only awaited these getters",
        "Run npm run test:run"
      ],
      "successCriteria": [
        "No lazy initialization for core services",
        "All 5,148 tests pass",
        "Startup time unchanged or faster"
      ],
      "currentPattern": "let _sessionManager: SessionManager | null = null; async function getSessionManager()...",
      "targetPattern": "import { sessionManager } from './session/manager.js';"
    },
    {
      "id": "15A.1.3",
      "category": "Types",
      "description": "Remove Interface Segregation Overkill - Replace 4 interfaces (each with exactly 1 implementation) with concrete types.",
      "status": "pending",
      "priority": "medium",
      "estimatedHours": 1.0,
      "agent": "haiku",
      "files": {
        "modify": [
          "src/interfaces/ILogger.ts",
          "src/repositories/ISessionRepository.ts",
          "src/session/storage/interface.ts"
        ]
      },
      "instructions": [
        "For each interface, verify only 1 implementation exists",
        "Merge interface into implementation class",
        "Update imports throughout codebase",
        "Run npm run typecheck and npm run test:run"
      ],
      "successCriteria": [
        "4 interfaces eliminated",
        "Type safety maintained",
        "All tests pass"
      ],
      "interfacesToRemove": [
        "ILogger - implemented only by Logger",
        "ISessionRepository - implemented only by MemorySessionRepository",
        "SessionStorage - implemented only by FileSessionStore",
        "ModeHandler - implemented generically"
      ]
    },
    {
      "id": "15A.1.4",
      "category": "Cleanup",
      "description": "Simplify ThoughtFactoryConfig - Remove unused configuration options that are never changed from defaults.",
      "status": "pending",
      "priority": "low",
      "estimatedHours": 0.5,
      "agent": "haiku",
      "files": {
        "modify": [
          "src/services/ThoughtFactory.ts"
        ]
      },
      "instructions": [
        "Search codebase for ThoughtFactoryConfig instantiation",
        "Verify defaults are always used",
        "Remove config parameter and interface",
        "Hardcode previously default values",
        "Run npm run test:run"
      ],
      "successCriteria": [
        "Configuration complexity removed",
        "All tests pass"
      ],
      "unusedOptions": [
        "useRegistryForAll - never changed from default",
        "autoRegisterHandlers - never changed from default",
        "logger - never injected externally"
      ]
    },
    {
      "id": "15A.1.5",
      "category": "Cleanup",
      "description": "Remove Barrel File Indirection - Simplify or replace 25 barrel re-export files with direct imports.",
      "status": "pending",
      "priority": "low",
      "estimatedHours": 1.0,
      "agent": "haiku",
      "files": {
        "modify": [
          "Multiple files importing from barrel exports"
        ],
        "delete": [
          "10+ unnecessary index.ts barrel files"
        ]
      },
      "instructions": [
        "Identify all 25 barrel files with: find src -name 'index.ts'",
        "For each internal barrel, change imports to direct file paths",
        "Keep only src/index.ts and src/types/index.ts for public API",
        "Delete or simplify other barrel files",
        "Run npm run typecheck and npm run test:run"
      ],
      "successCriteria": [
        "15+ barrel files eliminated or simplified",
        "Import paths are direct",
        "All tests pass"
      ]
    },
    {
      "id": "15A.1.6",
      "category": "Verification",
      "description": "Sprint 1 Verification - Run full test suite, create commit, update documentation.",
      "status": "pending",
      "priority": "high",
      "estimatedHours": 1.0,
      "agent": "sonnet",
      "files": {
        "verify": [
          "All modified files"
        ],
        "modify": [
          "docs/planning/PHASE_15A_SPRINT_1_TODO.json"
        ]
      },
      "instructions": [
        "Run npm run typecheck - must pass with 0 errors",
        "Run npm run test:run - all 5,148 tests must pass",
        "Run npm run build - must complete successfully",
        "Create git commit: 'refactor(v9.0.0): Phase 15A Sprint 1 - Remove Unnecessary Abstractions'",
        "Update this TODO file with actual hours and completion status"
      ],
      "successCriteria": [
        "All tasks 15A.1.1-15A.1.5 complete",
        "Build passes",
        "All tests pass",
        "Git commit created"
      ]
    }
  ],
  "successCriteria": [
    "ModeHandlerRegistry simplified or inlined",
    "Lazy service initialization removed",
    "4 interfaces with single implementations merged",
    "Unused config options removed",
    "10+ barrel files eliminated",
    "All 5,148 tests pass",
    "npm run build succeeds",
    "Git commit created"
  ],
  "filesCreated": [],
  "filesDeleted": [
    "Various barrel index.ts files (10+)"
  ],
  "filesSimplified": [
    "src/modes/registry.ts"
  ],
  "filesModified": [
    "src/services/ThoughtFactory.ts",
    "src/index.ts",
    "src/interfaces/ILogger.ts",
    "src/repositories/ISessionRepository.ts",
    "src/session/storage/interface.ts"
  ],
  "totalEstimatedHours": 6.0,
  "expectedReduction": {
    "linesOfCode": 500,
    "files": 12,
    "indirectionCalls": 8
  },
  "notes": "Sprint 1 focuses on removing pattern overhead without changing MCP API behavior. All changes are internal refactoring. Run verification after each task to catch breakage early."
}
